<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Multi-Agent Debate</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- Main Chat Area -->
        <main class="chat-main">
            <div class="chat-header">
                <h1>AI Multi-Agent Debate</h1>
                <div class="header-right">
                    <div id="status" class="status-bar">
                        <span class="status-indicator offline"></span>
                        <span id="statusText">ƒêang k·∫øt n·ªëi...</span>
                    </div>
                    <button id="helpBtn" class="btn-icon btn-help" title="H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="chat-container">
                <div id="messages" class="messages">
                    <div class="welcome-message">
                        <h2>Ch√†o m·ª´ng ƒë·∫øn v·ªõi AI Multi-Agent Debate!</h2>
                        <p>Nh·∫≠p m·ªôt ch·ªß ƒë·ªÅ v√† nh·∫•n "B·∫Øt ƒë·∫ßu" ƒë·ªÉ c√°c AI agent b·∫Øt ƒë·∫ßu th·∫£o lu·∫≠n.</p>
                    </div>
                </div>
                <button id="scrollToBottomBtn" class="scroll-to-bottom-btn" title="Cu·ªôn xu·ªëng cu·ªëi"
                    style="display: none;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
            </div>
        </main>

        <!-- Resize Handle -->
        <div class="resize-handle" id="resizeHandle"></div>

        <!-- Right Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-section">
                <h3>Ch·ªß ƒë·ªÅ</h3>
                <div class="topic-input">
                    <textarea id="topicInput" placeholder="Nh·∫≠p ch·ªß ƒë·ªÅ th·∫£o lu·∫≠n..." rows="4"></textarea>
                </div>
                <div class="topic-buttons">
                    <button id="startBtn" class="btn btn-primary btn-full">B·∫Øt ƒë·∫ßu m·ªõi</button>
                    <button id="continueBtn" class="btn btn-secondary btn-full" disabled>Ti·∫øp t·ª•c</button>
                </div>
                <div class="topic-buttons" style="margin-top: 8px;">
                    <button id="stopBtn" class="btn btn-danger btn-full" disabled>D·ª´ng</button>
                    <button id="nextAgentBtn" class="btn btn-secondary btn-full" disabled>Agent ti·∫øp theo</button>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>ƒêi·ªÅu khi·ªÉn</h3>
                <div class="control-row">
                    <select id="modeSelect" class="select-control">
                        <option value="round_robin">Round Robin</option>
                        <option value="free_form">Free Form</option>
                    </select>
                    <button id="autoBtn" class="btn btn-secondary" disabled>T·ª± ƒë·ªông</button>
                </div>
                <div class="control-buttons" style="margin-top: 8px;">
                    <button id="exportMdBtn" class="btn btn-outline btn-full">Export MD</button>
                    <button id="importMdBtn" class="btn btn-outline btn-full">Import MD</button>
                    <input type="file" id="importMdInput" accept=".md" style="display: none;">
                </div>
            </div>

            <div class="sidebar-section agents-section">
                <div class="agents-header">
                    <h3>Agents</h3>
                    <button id="manageAgentsBtn" class="btn btn-sm btn-outline" title="Qu·∫£n l√Ω Agents">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                    </button>
                </div>
                <div id="agentsList" class="agents-list">
                    <!-- Agents will be loaded here as buttons -->
                </div>
            </div>
        </aside>
    </div>

    <!-- Agent Manager Modal -->
    <div id="agentModal" class="modal">
        <div class="modal-content modal-xlarge">
            <div class="modal-header">
                <h2 id="agentModalTitle">Qu·∫£n l√Ω Agents</h2>
                <button class="modal-close" onclick="closeAgentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Agent List View -->
                <div id="agentListView">
                    <div class="agent-manager-toolbar">
                        <button id="addAgentBtn" class="btn btn-primary">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Th√™m Agent
                        </button>
                        <button id="saveOrderBtn" class="btn btn-secondary">L∆∞u th·ª© t·ª±</button>
                    </div>
                    <div id="agentManagerList" class="agent-manager-list">
                        <!-- Agents will be rendered here -->
                    </div>
                </div>

                <!-- Agent Edit Form (hidden by default) -->
                <div id="agentEditView" style="display: none;">
                    <form id="agentForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="agentId">ID <span class="required">*</span></label>
                                <input type="text" id="agentId" name="id" required placeholder="vd: analyst">
                                <small>ID duy nh·∫•t, kh√¥ng c√≥ d·∫•u c√°ch</small>
                            </div>
                            <div class="form-group">
                                <label for="agentName">T√™n <span class="required">*</span></label>
                                <input type="text" id="agentName" name="name" required placeholder="vd: Analyst">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="agentRole">Vai tr√≤</label>
                            <input type="text" id="agentRole" name="role"
                                placeholder="vd: Ph√¢n t√≠ch logic, data-driven">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="agentProvider">Provider</label>
                                <select id="agentProvider" name="provider">
                                    <option value="openai">OpenAI</option>
                                    <option value="anthropic">Anthropic</option>
                                    <option value="gemini">Gemini</option>
                                    <option value="ollama">Ollama</option>
                                    <option value="grok">Grok (xAI)</option>
                                    <option value="deepseek">DeepSeek</option>
                                    <option value="perplexity">Perplexity</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="agentModel">Model</label>
                                <input type="text" id="agentModel" name="model" placeholder="vd: gpt-4">
                            </div>
                        </div>
                        <!-- LLM Parameters Section -->
                        <div class="form-section">
                            <h4 class="form-section-title">Tham s·ªë LLM</h4>
                            <div class="form-row form-row-6">
                                <div class="form-group">
                                    <label for="agentTemperature">
                                        Temp
                                        <span class="tooltip-icon"
                                            title="ƒêi·ªÅu ch·ªânh ƒë·ªô ng·∫´u nhi√™n c·ªßa output. Gi√° tr·ªã cao (1.5-2) = s√°ng t·∫°o. Gi√° tr·ªã th·∫•p (0-0.5) = ch√≠nh x√°c.">‚ìò</span>
                                    </label>
                                    <input type="number" id="agentTemperature" name="temperature" min="0" max="2"
                                        step="0.1" value="0.7">
                                </div>
                                <div class="form-group">
                                    <label for="agentMaxTokens">
                                        Max Tokens
                                        <span class="tooltip-icon"
                                            title="S·ªë token t·ªëi ƒëa trong response. 0 = m·∫∑c ƒë·ªãnh c·ªßa model.">‚ìò</span>
                                    </label>
                                    <input type="number" id="agentMaxTokens" name="max_tokens" min="0" max="128000"
                                        step="100" value="0">
                                </div>
                                <div class="form-group">
                                    <label for="agentTopP">
                                        Top P
                                        <span class="tooltip-icon"
                                            title="Nucleus sampling. 0.1 = top 10% token. 1.0 = t·∫•t c·∫£.">‚ìò</span>
                                    </label>
                                    <input type="number" id="agentTopP" name="top_p" min="0" max="1" step="0.05"
                                        value="1">
                                </div>
                                <div class="form-group">
                                    <label for="agentTopK">
                                        Top K
                                        <span class="tooltip-icon"
                                            title="Ch·ªâ ch·ªçn K token x√°c su·∫•t cao nh·∫•t. 0 = t·∫Øt.">‚ìò</span>
                                    </label>
                                    <input type="number" id="agentTopK" name="top_k" min="0" max="100" step="1"
                                        value="0">
                                </div>
                                <div class="form-group">
                                    <label for="agentFrequencyPenalty">
                                        Freq Pen
                                        <span class="tooltip-icon"
                                            title="Ph·∫°t token theo t·∫ßn su·∫•t. D∆∞∆°ng = gi·∫£m l·∫∑p t·ª´. -2 ƒë·∫øn 2.">‚ìò</span>
                                    </label>
                                    <input type="number" id="agentFrequencyPenalty" name="frequency_penalty" min="-2"
                                        max="2" step="0.1" value="0">
                                </div>
                                <div class="form-group">
                                    <label for="agentPresencePenalty">
                                        Pres Pen
                                        <span class="tooltip-icon"
                                            title="Ph·∫°t token ƒë√£ xu·∫•t hi·ªán. D∆∞∆°ng = khuy·∫øn kh√≠ch ch·ªß ƒë·ªÅ m·ªõi. -2 ƒë·∫øn 2.">‚ìò</span>
                                    </label>
                                    <input type="number" id="agentPresencePenalty" name="presence_penalty" min="-2"
                                        max="2" step="0.1" value="0">
                                </div>
                            </div>
                        </div>

                        <!-- Other Settings -->
                        <div class="form-row form-row-3">
                            <div class="form-group form-group-color">
                                <label for="agentColor">M√†u</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="agentColor" name="color" value="#4A90D9">
                                    <input type="text" id="agentColorText" value="#4A90D9" placeholder="#4A90D9">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="agentBaseUrl">Base URL</label>
                                <input type="text" id="agentBaseUrl" name="base_url"
                                    placeholder="http://localhost:8045/v1">
                            </div>
                            <div class="form-group">
                                <label for="agentApiKey">API Key</label>
                                <input type="password" id="agentApiKey" name="api_key"
                                    placeholder="ƒê·ªÉ tr·ªëng = key m·∫∑c ƒë·ªãnh">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="agentSystemPrompt">System Prompt</label>
                            <textarea id="agentSystemPrompt" name="system_prompt" rows="8"
                                placeholder="Nh·∫≠p system prompt cho agent..."></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="showAgentList()">H·ªßy</button>
                            <button type="submit" class="btn btn-primary" id="saveAgentBtn">L∆∞u</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
                <button class="modal-close" onclick="closeHelpModal()">&times;</button>
            </div>
            <div class="modal-body help-content">
                <section class="help-section">
                    <h3>üéØ Gi·ªõi thi·ªáu</h3>
                    <p>AI Multi-Agent Debate l√† ·ª©ng d·ª•ng cho ph√©p nhi·ªÅu AI agents c√πng th·∫£o lu·∫≠n v·ªÅ m·ªôt ch·ªß ƒë·ªÅ. M·ªói
                        agent c√≥ vai tr√≤ v√† phong c√°ch ri√™ng, gi√∫p b·∫°n c√≥ ƒë∆∞·ª£c nhi·ªÅu g√≥c nh√¨n ƒëa d·∫°ng v·ªÅ v·∫•n ƒë·ªÅ.</p>
                </section>

                <section class="help-section">
                    <h3>üöÄ B·∫Øt ƒë·∫ßu nhanh</h3>
                    <ol>
                        <li><strong>Nh·∫≠p ch·ªß ƒë·ªÅ</strong> v√†o √¥ "Ch·ªß ƒë·ªÅ" ·ªü sidebar b√™n ph·∫£i</li>
                        <li>Nh·∫•n <strong>"B·∫Øt ƒë·∫ßu m·ªõi"</strong> ƒë·ªÉ kh·ªüi t·∫°o cu·ªôc th·∫£o lu·∫≠n</li>
                        <li>Agent ƒë·∫ßu ti√™n s·∫Ω t·ª± ƒë·ªông ph√°t bi·ªÉu</li>
                        <li>Click v√†o c√°c agent trong danh s√°ch ƒë·ªÉ y√™u c·∫ßu h·ªç ph√°t bi·ªÉu ti·∫øp</li>
                    </ol>
                </section>

                <section class="help-section">
                    <h3>üéÆ ƒêi·ªÅu khi·ªÉn</h3>
                    <div class="help-grid">
                        <div class="help-item">
                            <span class="help-label">B·∫Øt ƒë·∫ßu m·ªõi</span>
                            <span class="help-desc">X√≥a to√†n b·ªô v√† b·∫Øt ƒë·∫ßu th·∫£o lu·∫≠n m·ªõi v·ªõi ch·ªß ƒë·ªÅ ƒë√£ nh·∫≠p</span>
                        </div>
                        <div class="help-item">
                            <span class="help-label">Ti·∫øp t·ª•c</span>
                            <span class="help-desc">Th√™m ch·ªß ƒë·ªÅ m·ªõi v√†o cu·ªôc th·∫£o lu·∫≠n hi·ªán t·∫°i</span>
                        </div>
                        <div class="help-item">
                            <span class="help-label">D·ª´ng</span>
                            <span class="help-desc">T·∫°m d·ª´ng cu·ªôc th·∫£o lu·∫≠n ƒëang di·ªÖn ra</span>
                        </div>
                        <div class="help-item">
                            <span class="help-label">Agent ti·∫øp theo</span>
                            <span class="help-desc">Y√™u c·∫ßu agent ti·∫øp theo ph√°t bi·ªÉu (theo th·ª© t·ª±)</span>
                        </div>
                        <div class="help-item">
                            <span class="help-label">T·ª± ƒë·ªông</span>
                            <span class="help-desc">B·∫≠t/t·∫Øt ch·∫ø ƒë·ªô t·ª± ƒë·ªông - c√°c agent s·∫Ω l·∫ßn l∆∞·ª£t ph√°t bi·ªÉu</span>
                        </div>
                    </div>
                </section>

                <section class="help-section">
                    <h3>ü§ñ Qu·∫£n l√Ω Agents</h3>
                    <ul>
                        <li><strong>Checkbox:</strong> Ch·ªçn/b·ªè ch·ªçn agents tham gia ch·∫ø ƒë·ªô t·ª± ƒë·ªông</li>
                        <li><strong>K√©o th·∫£:</strong> S·∫Øp x·∫øp l·∫°i th·ª© t·ª± ph√°t bi·ªÉu c·ªßa agents</li>
                        <li><strong>N√∫t ‚öôÔ∏è:</strong> M·ªü c·ª≠a s·ªï qu·∫£n l√Ω ƒë·ªÉ th√™m, s·ª≠a, x√≥a agents</li>
                        <li><strong>Toggle on/off:</strong> ·∫®n/hi·ªán agent kh·ªèi panel b√™n c·∫°nh</li>
                    </ul>
                </section>

                <section class="help-section">
                    <h3>üíæ Xu·∫•t/Nh·∫≠p d·ªØ li·ªáu</h3>
                    <ul>
                        <li><strong>Export MD:</strong> Xu·∫•t to√†n b·ªô cu·ªôc th·∫£o lu·∫≠n ra file Markdown (.md)</li>
                        <li><strong>Import MD:</strong> Nh·∫≠p file Markdown ƒë√£ xu·∫•t tr∆∞·ªõc ƒë√≥ ƒë·ªÉ xem l·∫°i</li>
                    </ul>
                </section>

                <section class="help-section">
                    <h3>üîå Providers h·ªó tr·ª£</h3>
                    <div class="help-providers">
                        <span class="provider-badge">OpenAI</span>
                        <span class="provider-badge">Anthropic</span>
                        <span class="provider-badge">Gemini</span>
                        <span class="provider-badge">Ollama</span>
                        <span class="provider-badge">Grok</span>
                        <span class="provider-badge">DeepSeek</span>
                        <span class="provider-badge">Perplexity</span>
                    </div>
                    <p class="help-note">M·ªói agent c√≥ th·ªÉ s·ª≠ d·ª•ng m·ªôt provider kh√°c nhau. C·∫•u h√¨nh trong ph·∫ßn Qu·∫£n l√Ω
                        Agents.</p>
                </section>

                <section class="help-section">
                    <h3>‚å®Ô∏è Ph√≠m t·∫Øt</h3>
                    <div class="help-grid">
                        <div class="help-item">
                            <kbd>Ctrl</kbd> + <kbd>Enter</kbd>
                            <span class="help-desc">B·∫Øt ƒë·∫ßu/Ti·∫øp t·ª•c th·∫£o lu·∫≠n</span>
                        </div>
                    </div>
                </section>

                <section class="help-section">
                    <h3>üí° M·∫πo s·ª≠ d·ª•ng</h3>
                    <ul>
                        <li>S·ª≠ d·ª•ng ch·∫ø ƒë·ªô <strong>Round Robin</strong> ƒë·ªÉ c√°c agent ph√°t bi·ªÉu l·∫ßn l∆∞·ª£t theo th·ª© t·ª±</li>
                        <li>S·ª≠ d·ª•ng ch·∫ø ƒë·ªô <strong>Free Form</strong> ƒë·ªÉ t·ª± do ch·ªçn agent ph√°t bi·ªÉu</li>
                        <li>Trong ch·∫ø ƒë·ªô t·ª± ƒë·ªông, ch·ªâ c√°c agents ƒë∆∞·ª£c check m·ªõi tham gia th·∫£o lu·∫≠n</li>
                        <li>C√≥ th·ªÉ k√©o sidebar ƒë·ªÉ thay ƒë·ªïi k√≠ch th∆∞·ªõc</li>
                    </ul>
                </section>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <script src="app.js"></script>
</body>

</html>